---
layout: "@/layouts/BlogDetailLayout.astro"
title: 落ち葉をまわせてみる
description: blenderでパーティクルシステムを利用した落ち葉の演出です。
createAt: 2022-10-06
thumbnail: "/blog/thumbnail/blender_thumb.png"
tags: ["Blender"]
draft: false
---

import CommonImg from "@/components/CommonImg.tsx";

パーティクルシステムを利用した、落ち葉の演出です。

## 平面を2枚用意する

まずは、「メッシュ > 平面」から平面メッシュを作成し、以下の画像のように上下に並べます。

上がパーティクルシステムを追加する為のもの。  
下がパーティクルを止めるためのコリジョン設定をする為のものになります。

<CommonImg
  src="/blog/20221006/01.png"
  alt="平面を2枚用意する"
  client:only="react"
/>

## 落ち葉を用意する

パーティクルのオブジェクトインスタンスに指定する桜の花びらを作成します。
マテリアルには画像を利用します。

[画像テクスチャで立体的な草を簡単に作成する](https://satofaction.net/blog/20221005)と同じ方法で平面メッシュにテクスチャ、UVを設定していきます。

### ◎シェーダーエディタ

<CommonImg
  src="/blog/20221006/02.png"
  alt="シェーダーエディタ"
  client:only="react"
/>

### ◎UVエディタ

葉が1枚だけ入るように、メッシュを分割して頂点を調整しています。

<CommonImg
  src="/blog/20221006/03.png"
  alt="UVエディタ"
  client:only="react"
/>

## 桜の花びら用のパーティクルを設定する

上に配置した平面メッシュに、パーティクルを設定していきます。  
その際に、「モディファイアー > マスク」を設定するとパーティクル発生元のメッシュを見えなくすることができます。

<CommonImg
  src="/blog/20221006/04.png"
  alt="桜の花びら用のパーティクルを設定する"
  client:only="react"
/>

パーティクルシステムの設定は以下になります。  
こちらは表示を見ながら調整します。

| 項目             | プロパティ           | 値                                  | 補足                                                                                                  |
| ---------------- | -------------------- | ----------------------------------- | ----------------------------------------------------------------------------------------------------- |
| 放射             | 数                   | 100                                 | 任意                                                                                                  |
| 放射             | 開始フレーム         | -50                                 | 開始からインスタンスが全体に表示されるように少しマイナスを設定(任意)                                  |
| 放射             | 終了フレーム         | 250                                 | タイムラインのフレーム数に合わせる                                                                    |
| 放射             | 寿命                 | 250                                 | タイムラインのフレーム数に合わせる                                                                    |
| 速度             | ノーマル             | -1m/s                               | すぐに落下させたいので                                                                                |
| レンダー         | レンダリング方法     | オブジェクト                        | 葉のオブジェクトをインスタンスに指定                                                                  |
| レンダー         | スケール             | ビューを見ながら決める              | 初期値だと小さすぎる                                                                                  |
| レンダー         | スケールのランダム化 | ビューを見ながら決める              |                                                                                                       |
| フィールドの重み | 重力                 | ビューを見ながら決める              | 初期値だと早すぎる                                                                                    |
| 回転             | ランダム化           | ビューを見ながら決める(1が良いかも) |                                                                                                       |
| 回転             | 位相                 | ビューを見ながら決める              |                                                                                                       |
| 回転             | 位相のランダム化     | ビューを見ながら決める              |                                                                                                       |
| 回転 > 角速度    | 座標軸               | ランダム                            | 角速度を設定すると毎フレームごとの回転する<br />「回転 > ダイナミック」にチェックを入れると利用できる |
| 回転 > 角速度    | 量                   | ビューを見ながら決める              |                                                                                                       |

## 物理演算の設定を追加

下側のメッシュに物理演算プロパティから「コリジョン」を追加します。

<CommonImg
  src="/blog/20221006/05.png"
  alt="物理演算の設定を追加"
  client:only="react"
/>

| 項目         | プロパティ | 値                     | 補足 |
| ------------ | ---------- | ---------------------- | ---- |
| パーティクル | 付着土     | ビューを見ながら決める |      |
| パーティクル | 摩擦       | ビューを見ながら決める |      |

## 乱流を追加して動きを与える

「フォースフィールド > 乱流」を追加します。

<CommonImg
  src="/blog/20221006/06.png"
  alt="乱流を追加して動きを与える"
  client:only="react"
/>

| 項目 | プロパティ | 値                     | 補足             |
| ---- | ---------- | ---------------------- | ---------------- |
| 設定 | 強さ       | ビューを見ながら決める | 乱流影響力の強さ |
| 設定 | サイズ     | ビューを見ながら決める | 乱れの大きさ     |

<CommonImg
  src="/blog/20221006/07.png"
  alt="乱流を追加して動きを与える"
  client:only="react"
/>
